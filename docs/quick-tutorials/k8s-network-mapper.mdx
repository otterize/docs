---
sidebar_position: 3
title: Map your cluster
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import styles from '/src/css/styles.module.css';

The network mapper allows you to map pod-to-pod traffic within your K8s cluster.

In this tutorial, we will:

- Deploy a server, and two clients calling it.
- Map their communication using the network mapper.

<details>
<summary>Make sure you have a Kubernetes cluster</summary>

Before you start, you need to have a Kubernetes cluster. Having a cluster with a [CNI](https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/) that supports [NetworkPolicies](https://kubernetes.io/docs/concepts/services-networking/network-policies/) isn't required for this tutorial, but is recommended so that your cluster works with other tutorials.

{@include: ../_common/cluster-setup.md}
</details>

<details>
<summary>Install Otterize on your cluster</summary>

:::note
You can skip this section if Otterize is already installed in your cluster.
:::

{@include: ../_common/install-otterize.md}

</details>

<details>
<summary>Connect to Otterize Cloud (optional)</summary>
Upgrade/install your Otterize OSS deployment using the *client id* and *client secret* generated for your integration.

{@include: ../_common/install-otterize-cloud.md}

For detailed instructions follow this [guide](/installation#connect-otterize-oss-to-otterize-cloud)
</details>

## Map the cluster

The network mapper starts to sniff traffic and build an in-memory network map as soon as it's installed.
The Otterize CLI allows you to interact with the network mapper to grab a snapshot of current mapped traffic,
reset its state and more. For a complete list of the CLI capabilities read the [CLI command reference](/reference/cli/#network-mapper).
Otterize Cloud allows you to visualize that data in the [access graph-broken link](/broken/link).

### Deploy demo to simulate traffic

Let's add traffic to the cluster and see how the network mapper tracks it.
Deploy the following simple example &mdash; `client`, `client2` and `server`, communicating over HTTP:
```shell
kubectl apply -n otterize-tutorial-mapper -f https://docs.otterize.com/code-examples/network-mapper/all.yaml
```

### Show mapped traffic

{@include: ../getting-started/_show_mapped_traffic_cli.mdx}

### Visualize using the access graph (Cloud)

You can visualize mapped traffic with the [access graph](https://app.staging.otterize.com/access-graph) on Otterize Cloud.

<img src="/img/quick-tutorials/network-mapper/map.png" alt="Discovered intents" width="600"/>

:::info
Learn more about [Shadow mode](/realistic-example/shadow-mode-network-policies) to see how the access graph can be used for gradually rolling out intents.
:::



## What's next

The network mapper is a great way to bootstrap IBAC. It generates client intents files that reflect
the current topology of your services; those can then be used by each client team to grant them easy
and *secure* access to the services they need, and as their needs evolve, they need only evolve
the intents files. We'll see more of that below.

Where to go next?

- If you haven't already, see the [automate network policies tutorial](/k8s-network-policies).
- Or go to the next tutorial to [automate secure access for Kafka](/k8s-kafka-mtls).
- You might also dive deeper into the guide for [IBAC with network policies](../capabilities/network-policies).
  - It even contains a bootstrapping exercise at the end!
- For a deeper dive into the network mapper, see the guide for [mapping pod-to-pod calls](../capabilities/k8s-mapping-pod-to-pod-calls).
- Explore how [Shadow Mode](/k8s-shadow-mode) can expand these capabilities.

### Teardown

To remove the deployed examples run:

```bash
kubectl delete namespace otterize-tutorial-mapper
```
