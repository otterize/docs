---
sidebar_position: 2
title: Map your cluster switch
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import styles from '/src/css/styles.module.css';

The network mapper allows you to map pod-to-pod traffic within your K8s cluster.

In this tutorial, we will:

- Deploy a server, and two clients calling it.
- Map their communication using the network mapper.

<details>
<summary>Make sure you have a Kubernetes cluster</summary>

Before you start, you need to have a Kubernetes cluster. Having a cluster with a [CNI](https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/) that supports [NetworkPolicies](https://kubernetes.io/docs/concepts/services-networking/network-policies/) isn't required for this tutorial, but is recommended so that your cluster works with other tutorials.

{@include: ../_common/cluster-setup.md}
</details>

## Install the network mapper on your K8s cluster
<Tabs groupId="oss-cloud">
<TabItem value="k8s" label="K8s" attributes={{className: styles.red}}>

{@include: ../_common/install-otterize-network-mapper.md}

</TabItem>
<TabItem value="cloud" label="K8s+Cloud ☁️" attributes={{className: styles.orange}}>

{@include: ../_common/connect-otterize-to-cloud.md}
</TabItem>
</Tabs>




## Map the cluster

The network mapper starts to sniff traffic and build an in-memory network map as soon as it's installed.
The Otterize CLI allows you to interact with the network mapper to grab a snapshot of current mapped traffic,
reset its state and more. For a complete list of the CLI capabilities read the [CLI command reference](/reference/cli/#network-mapper).
Otterize Cloud allows you to visualize that data in the [access graph-broken link](/broken/link).

### Deploy demo to simulate traffic

Let's add traffic to the cluster and see how the network mapper tracks it.
Deploy the following simple example &mdash; `client`, `client2` and `server`, communicating over HTTP:
```shell
kubectl apply -n otterize-tutorial-mapper -f https://docs.otterize.com/code-examples/network-mapper/all.yaml
```

### Show mapped traffic

<Tabs groupId="oss-cloud">
<TabItem value="k8s" label="K8s" attributes={{className: styles.red}}>
<details>
<summary>Install the Otterize CLI</summary>
{@include: ../_common/install-otterize-cli.md}
</details>

{@include: ../getting-started/_show_mapped_traffic_cli.mdx}

</TabItem>
<TabItem value="cloud" label="K8s+Cloud ☁️" attributes={{className: styles.orange}}>

{@include: ../getting-started/_show_mapped_traffic_cloud.mdx}
</TabItem>
</Tabs>



## What's next

The network mapper is a great way to bootstrap IBAC. It generates client intents files that reflect
the current topology of your services; those can then be used by each client team to grant them easy
and *secure* access to the services they need, and as their needs evolve, they need only evolve
the intents files. We'll see more of that below.

Where to go next?

- If you haven't already, see the [automate network policies tutorial](/quick-tutorials/k8s-network-policies).
- Or go to the next tutorial to [automate secure access for Kafka](/quick-tutorials/k8s-kafka-mtls).
- You might also dive deeper into the guide for [IBAC with network policies](../capabilities/network-policies).
  - It even contains a bootstrapping exercise at the end!
- For a deeper dive into the network mapper, see the guide for [mapping pod-to-pod calls](../capabilities/k8s-mapping-pod-to-pod-calls).

### Teardown

To remove the deployed examples run:

```bash
kubectl delete namespace otterize-tutorial-mapper
```
