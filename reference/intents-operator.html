<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/intents-operator/README" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Intents operator | Otterize</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.otterize.com/reference/intents-operator"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Intents operator | Otterize"><meta data-rh="true" name="description" content="The Otterize intents operator is an open source Kubernetes operator for easily managing service-to-service authorization"><meta data-rh="true" property="og:description" content="The Otterize intents operator is an open source Kubernetes operator for easily managing service-to-service authorization"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.otterize.com/reference/intents-operator"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/reference/intents-operator" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/reference/intents-operator" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://69PZ47MO2R-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Otterize" href="/opensearch.xml">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2EG876ZREF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2EG876ZREF",{})</script>

<script src="/newsLetterSubscription.js" async></script>
<script src="/ui.js" async></script>
<script src="/pixels.js" async></script>
<script src="https://app.otterize.com/static/hs.js" async></script><link rel="stylesheet" href="/assets/css/styles.66012bca.css">
<link rel="preload" href="/assets/js/runtime~main.d8e6c6c1.js" as="script">
<link rel="preload" href="/assets/js/main.2e15d3e2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://otterize.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--light_HNdA" style="padding-left:15px"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--dark_i4oU" style="padding-left:15px"></div></a><a href="https://docs.otterize.com/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Documentation</div></a><a href="https://www.otterize.com/pricing" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Pricing</div></a><a href="https://www.otterize.com/resources" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Blog</div></a><a href="https://www.otterize.com/team" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Team</div></a></div><div class="navbar__items navbar__items--right"><a href="https://app.otterize.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><div id="login-link" class="tw-inline-flex tw-h-11 tw-w-24 tw-items-center tw-justify-center tw-gap-2 tw-rounded-lg tw-px-4 tw-py-2.5 tw-text-sm lg:tw-text-base tw-font-semibold tw-leading-normal tw-text-gray-600 tw-no-underline -tw-mr-10">Log in</div></a><a href="https://joinslack.otterize.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><img width="30" height="30" loading="lazy" src="/img/footer/slack.svg" alt="Slack logo" classname="w-5 h-5 relative"></a><a href="https://otterize.com/signup" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><button class="tw-cursor-pointer tw-inline-flex tw-items-center tw-justify-center tw-gap-2 tw-rounded-xl tw-bg-gradient-to-b tw-px-3 tw-py-2.5 tw-text-sm lg:tw-text-base tw-font-semibold tw-leading-normal tw-no-underline tw-shadow tw-font-sans -tw-mr-2 tw-from-indigo-500 tw-bg-indigo-500 tw-to-indigo-600 tw-h-11 tw-border-none tw-text-white tw-w-full"><img src="/img/menu/cloud.svg">Signup <span id="sign-extended-text">for free<span></span></span></button></a><a href="https://otterize.com/book-demo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-cursor-pointer tw-font-sans tw-flex tw-items-center tw-rounded-xl tw-h-11 tw-border tw-border-solid tw-border-gray-300 tw-bg-white tw-px-3 tw-text-gray-900 tw-shadow tw-font-medium tw-text-sm lg:tw-text-base tw-w-full tw-justify-center"><span id="request-demo-full-text">Request a demo</span><span id="request-demo-partial-text">Demo</span><img class="tw-ml-2" src="/img/menu/right-arrow.svg"></div></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/features">Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Features&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/network-mapping-network-policies">Network mapping &amp; network policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network mapping &amp; network policies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/aws-iam">AWS IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;AWS IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/azure-iam">Microsoft Azure IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;Microsoft Azure IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/gcp-iam">Google Cloud IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;Google Cloud IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/kafka">Kafka</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kafka&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/istio">Istio</a><button aria-label="Toggle the collapsible sidebar category &#x27;Istio&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/mysql">MySQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;MySQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/postgresql">PostgreSQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;PostgreSQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/github">GitHub</a><button aria-label="Toggle the collapsible sidebar category &#x27;GitHub&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/gitlab">GitLab</a><button aria-label="Toggle the collapsible sidebar category &#x27;GitLab&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/reference/intents-operator">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/reference/intents-operator">Intents operator</a><button aria-label="Toggle the collapsible sidebar category &#x27;Intents operator&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/intents-operator/helm-chart">Helm chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/intents-operator/configuration">Configuring Kafka brokers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/reference/network-mapper">Network mapper</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network mapper&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/reference/credentials-operator">Credentials operator</a><button aria-label="Toggle the collapsible sidebar category &#x27;Credentials operator&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/otterize-chart">Otterize OSS Helm chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/service-identities">Service identities and resolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/IBAC-Overview">IBAC: Intent-based access control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/terminology">Terminology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/mtls">Kubernetes mTLS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/shadow-vs-active-enforcement">Shadow vs active enforcement</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/validating-clientintents">Validating ClientIntents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/cli">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/api">API</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Intents operator</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Intents operator</h1></header><p>The Otterize intents operator is an open source Kubernetes operator for easily managing service-to-service authorization
by declaring the calls each service needs to make, using <a href="/overview/intent-based-access-control">client intents files</a>.
The intents operator uses these files to configure network policies, Kafka ACLs, and other enforcement points (in the future) to allow just the intended calls.</p><p>If credentials such as X.509 certificates are needed for authentication <!-- -->—<!-- --> for example,
to connect to Kafka using mTLS <!-- -->—<!-- --> the Otterize intents operator works with SPIRE via the
<a href="/reference/credentials-operator">credentials operator</a> to automatically:</p><ul><li>Establish pod service identities.</li><li>Generate trusted credentials for each client service.</li><li>Deliver the credentials to the pod&#x27;s containers within a locally-mounted volume.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-the-intents-operator">Deploying the intents operator<a href="#deploying-the-intents-operator" class="hash-link" aria-label="Direct link to Deploying the intents operator" title="Direct link to Deploying the intents operator">​</a></h2><p>To deploy the operator, <a href="/reference/intents-operator/helm-chart">use the Helm chart</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-the-intents-operator">Monitoring the intents operator<a href="#monitoring-the-intents-operator" class="hash-link" aria-label="Direct link to Monitoring the intents operator" title="Direct link to Monitoring the intents operator">​</a></h2><p>The intents operator pod exposes a Prometheus metrics endpoint on port 2112, on <code>/metrics</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="controlling-access-using-the-intents-operator">Controlling access using the intents operator<a href="#controlling-access-using-the-intents-operator" class="hash-link" aria-label="Direct link to Controlling access using the intents operator" title="Direct link to Controlling access using the intents operator">​</a></h2><p>To learn how to use the intents operator to control access, head over to the <a href="/#features--tutorials">Features &amp; tutorials</a> section on the main page, or have a look on the sidebar.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pod-annotations">Pod annotations<a href="#pod-annotations" class="hash-link" aria-label="Direct link to Pod annotations" title="Direct link to Pod annotations">​</a></h2><p>You can override the service name the intents operator uses when it computes network policies and Kafka ACLs with a pod annotation.</p><table><thead><tr><th>Annotation</th><th>Description</th></tr></thead><tbody><tr><td><code>intents.otterize.com/service-name</code></td><td>Used for <a href="/reference/service-identities#kubernetes-service-identity-resolution">service identity resolution</a>.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-enforcement-types">Supported enforcement types<a href="#supported-enforcement-types" class="hash-link" aria-label="Direct link to Supported enforcement types" title="Direct link to Supported enforcement types">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-policies">Network policies<a href="#network-policies" class="hash-link" aria-label="Direct link to Network policies" title="Direct link to Network policies">​</a></h3><p>The intents operator automatically creates, updates and deletes network policies, and automatically labels client and server pods, to reflect precisely the client-to-server calls declared in client intents files.</p><p>The intents operator can also be configured to process client intents <em>without</em> creating and managing network policies, to provide visibility on what would happen once enforcement via network policies is activated. More information can be found in the <a href="/reference/shadow-vs-active-enforcement">shadow vs active enforcement documentation</a>.</p><p>In the example above, the <code>checkoutservice</code> intends to call the <code>shippingservice</code>. When the CRD is applied through <code>kubectl apply</code>, the intents operator labels the <code>checkoutservice</code> and <code>shippingservice</code> pods, and creates a network policy for the ingress of the <code>shippingservice</code> that references these labels and allows calls to the <code>shippingservice</code> from the <code>checkoutservice</code>.</p><p>See <a href="/reference/service-identities">service identities and resolution</a> to learn how service names are resolved for pods.</p><p>The intents operator uses the resolved identity as the service name, and combines it with the namespace of the pod and hashed to form the value of the label <code>intents.otterize.com/server</code>.
This label is used as a selector for network policies. Another
label, <code>intents.otterize.com/access-server-&lt;servicename&gt;-&lt;servicehash&gt;</code>, is applied to client pods which have declared their intent
to access the server. This label is used as the selector to determine which client pods are allowed to access the server
pod.</p><p>Learn more: <a href="/features/network-mapping-network-policies/reference/Network-Policies-Deep-Dive">Network policies deep dive</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-external-traffic">Handling external traffic<a href="#handling-external-traffic" class="hash-link" aria-label="Direct link to Handling external traffic" title="Direct link to Handling external traffic">​</a></h4><p>The intents operator has automatic behavior for allowing external traffic for pods which have indicated that they are supposed to accept external traffic, such as by creating a <code>Service</code> of type <code>NodePort</code> or <code>LoadBalancer</code>, or an <code>Ingress</code> resource.</p><p>As the intents operator creates network policies, and the semantics of network policies dictate that:</p><ol><li>if no network policies apply to a pod, then all traffic is allowed.</li><li>once any network policy applies to a pod, only the traffic explicitly allowed in the policy is allowed</li></ol><p>This meant that if you had no network policies on a pod, and created ClientIntents for that pod, then external traffic would be blocked. To make it easy to enable pod-to-pod traffic without affecting expected external traffic, the intents operator automatically detects resources of kind <code>Service</code> of type <code>NodePort</code> or <code>LoadBalancer</code>, or an <code>Ingress</code> resource, and if it creates the first network policy to affect those pods, it also creates a network policy that allows external traffic to those pods, as specified by the external <code>Service</code>/<code>Ingress</code> - for example, it only allows traffic to the specified ports, not all traffic.</p><p>This behavior can be disabled using the Helm chart&#x27;s values.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws-iam">AWS IAM<a href="#aws-iam" class="hash-link" aria-label="Direct link to AWS IAM" title="Direct link to AWS IAM">​</a></h3><p>The intents operator enables automatic management of AWS IAM roles and policies according to the
declared intents. It works together with the <a href="/reference/credentials-operator">Otterize credentials operator</a> to easily enable secure access
to AWS cloud resources from client pods, all in your Kubernetes cluster.</p><p>Try the <a href="https://docs.otterize.com/quickstart/access-control/aws-iam-eks" target="_blank" rel="noopener noreferrer">AWS IAM tutorial</a> to learn more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-iam">Azure IAM<a href="#azure-iam" class="hash-link" aria-label="Direct link to Azure IAM" title="Direct link to Azure IAM">​</a></h3><p>The intents operator enables automatic management of Azure managed identities and role assignments according to the
declared intents. It works together with the <a href="/reference/credentials-operator">Otterize credentials operator</a> to easily enable secure access
to Azure cloud resources from client pods, all in your Kubernetes cluster.</p><p>Try the <a href="https://docs.otterize.com/features/azure-iam/tutorials/azure-iam-aks" target="_blank" rel="noopener noreferrer">Azure IAM tutorial</a> to learn more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="google-cloud-iam">Google Cloud IAM<a href="#google-cloud-iam" class="hash-link" aria-label="Direct link to Google Cloud IAM" title="Direct link to Google Cloud IAM">​</a></h3><p>The intents operator enables automatic management of Google Cloud service accounts and policies according to the
declared intents. It works together with the <a href="/reference/credentials-operator">Otterize credentials operator</a> to easily enable secure access
to Azure cloud resources from client pods, all in your Kubernetes cluster.</p><p>Try the <a href="https://docs.otterize.com/features/gcp-iam/tutorials/gcp-iam-gke" target="_blank" rel="noopener noreferrer">GCP IAM tutorial</a> to learn more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-mtls--acls">Kafka mTLS &amp; ACLs<a href="#kafka-mtls--acls" class="hash-link" aria-label="Direct link to Kafka mTLS &amp; ACLs" title="Direct link to Kafka mTLS &amp; ACLs">​</a></h3><p>The intents operator automatically creates, updates, and deletes ACLs in Kafka clusters running within your Kubernetes cluster according to the declared intents. It does not modify other ACLs. It works together with the <a href="/reference/credentials-operator">Otterize credentials operator</a> to easily enable secure access to Kafka from client pods, all in your Kubernetes cluster.</p><p>The intents operator can also be configured to process client intents <em>without</em> creating and managing Kafka ACLs, to provide visibility on what would happen once enforcement via Kafka ACLs is activated. More information can be found in the <a href="/reference/shadow-vs-active-enforcement">shadow vs active enforcement documentation</a>.</p><p>The Otterize credentials operator automatically registers client pods with the credentials service <!-- -->—<!-- --> either a SPIRE server, or the Otterize Cloud-managed credentials service <!-- -->—<!-- --> and writes the trusted credentials generated by that service into Kubernetes secrets for use by those pods. The intents operator takes <code>ClientIntents</code> with <code>type: kafka</code> and creates Kafka ACLs that grant the requested access to the cryptographic identities (SVIDs) created by the credentials operator.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="acl-creation-and-consumer-groups">ACL creation and consumer groups<a href="#acl-creation-and-consumer-groups" class="hash-link" aria-label="Direct link to ACL creation and consumer groups" title="Direct link to ACL creation and consumer groups">​</a></h4><p>A Kafka client may specify a consumer group ID when consuming a topic. When it does so, it requires DESCRIBE and READ access to the consumer group resource.
To enable this, the intents operator creates an ACL enabling all consumers to read and describe all consumer groups.
The permission check performed by the AclAuthorizer for a consumer group also takes into account whether the consumer has the appropriate access to the topic
it is attempting to read, so the end result is that the topic ACLs determine actual access.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql-users--access">PostgreSQL users &amp; access<a href="#postgresql-users--access" class="hash-link" aria-label="Direct link to PostgreSQL users &amp; access" title="Direct link to PostgreSQL users &amp; access">​</a></h3><p>The intents operator automatically creates, and updates credentials in PostgreSQL databases according to the declared intents. It works together with the Otterize credentials operator to easily enable secure access to PostgreSQL from client pods, all in your Kubernetes cluster.</p><p>Try the <a href="/features/postgresql/tutorials/postgres">Just-in-time PostgreSQL users &amp; access</a> tutorial to learn more.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="istio-authorizationpolicy">Istio AuthorizationPolicy<a href="#istio-authorizationpolicy" class="hash-link" aria-label="Direct link to Istio AuthorizationPolicy" title="Direct link to Istio AuthorizationPolicy">​</a></h3><p>The intents operator automatically creates, updates and deletes Istio authorization policies, automatically looks up service accounts for client pods and labels server pods, to reflect precisely the client-to-server calls declared in client intents files.</p><p>The intents operator can also be configured to process client intents <em>without</em> creating and managing Istio authorization policies, to provide visibility on what would happen once enforcement via Istio authorization policy is activated. More information can be found in the <a href="/reference/shadow-vs-active-enforcement">shadow vs active enforcement documentation</a>.</p><p>In the example above, the <code>checkoutservice</code> intends to call the <code>shippingservice</code>. When the CRD is applied through <code>kubectl apply</code>, the intents operator labels the <code>shippingservice</code> pod, looks up <code>checkoutservice</code>&#x27;s service account, and creates an authorization policy for the ingress of the <code>shippingservice</code> that references the service account and allows calls to the <code>shippingservice</code> from the <code>checkoutservice</code>.</p><p>See <a href="/reference/service-identities">service identities and resolution</a> to learn how service names are resolved for pods.</p><p>The intents operator uses the resolved identity as the service name, and combines it with the namespace of the pod and hashed to form the value of the label <code>intents.otterize.com/server</code>.
This label is used as a selector for servers in Istio authorization policies. The same algorithm is used to look up the client from the service name in the client intents, for whom the service account is looked up.</p><p>Finally, an Istio authorization policy is created that allows communication between the client&#x27;s service account and the server. If the service account covers clients other than the one requested, an event is generated on the ClientIntents to warn about this, and this appears as a warning on Otterize Cloud.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="handling-external-traffic-1">Handling external traffic<a href="#handling-external-traffic-1" class="hash-link" aria-label="Direct link to Handling external traffic" title="Direct link to Handling external traffic">​</a></h4><p>Coming soon: automated handling of external traffic based on the presence of an <code>Ingress</code>, <code>Service</code> of type <code>LoadBalancer</code>, <code>IstioGateway</code> or <code>Gateway</code> API, like <a href="#handling-external-traffic">in network policies</a>.</p><p>When an Istio authorization policy is created for a server, it will only allow incoming traffic that matches the policy.</p><p>To allow external traffic from outside the cluster to a server, create an <code>AuthorizationPolicy</code> that allows all traffic, traffic that does not come from within the cluster by IP range, or traffic from ingress pods. Create this AuthorizationPolicy alongside the <code>Ingress</code>, <code>Service</code> or <code>Gateway</code> resource, such as in the same Helm chart.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/otterize/docs/edit/main/docs/reference/intents-operator/README.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/features/gitlab/reference"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/intents-operator/helm-chart"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Helm chart</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#deploying-the-intents-operator" class="table-of-contents__link toc-highlight">Deploying the intents operator</a></li><li><a href="#monitoring-the-intents-operator" class="table-of-contents__link toc-highlight">Monitoring the intents operator</a></li><li><a href="#controlling-access-using-the-intents-operator" class="table-of-contents__link toc-highlight">Controlling access using the intents operator</a></li><li><a href="#pod-annotations" class="table-of-contents__link toc-highlight">Pod annotations</a></li><li><a href="#supported-enforcement-types" class="table-of-contents__link toc-highlight">Supported enforcement types</a><ul><li><a href="#network-policies" class="table-of-contents__link toc-highlight">Network policies</a></li><li><a href="#aws-iam" class="table-of-contents__link toc-highlight">AWS IAM</a></li><li><a href="#azure-iam" class="table-of-contents__link toc-highlight">Azure IAM</a></li><li><a href="#google-cloud-iam" class="table-of-contents__link toc-highlight">Google Cloud IAM</a></li><li><a href="#kafka-mtls--acls" class="table-of-contents__link toc-highlight">Kafka mTLS &amp; ACLs</a></li><li><a href="#postgresql-users--access" class="table-of-contents__link toc-highlight">PostgreSQL users &amp; access</a></li><li><a href="#istio-authorizationpolicy" class="table-of-contents__link toc-highlight">Istio AuthorizationPolicy</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><span class="footer__link-item">
                <div class="footer_left">
                  <div class="tw-w-96 tw-h-60 tw-flex-col tw-justify-start tw-items-start tw-gap-6 tw-inline-flex">
                    <div class="tw-w-36 tw-h-8 tw-justify-start tw-items-start tw-inline-flex">
                      <img class="tw-w-40 tw-h-16 tw-relative tw-rounded-lg" src="/img/logo.svg">
                    </div>
                    <div id="mailchimp_title" class="tw-w-96 tw-text-gray-700 tw-text-xl tw-font-normal tw-font-sans tw-text-left">Join our newsletter to stay up to date on features and releases.</div>
                    <div class="tw-h-28 tw-flex-col tw-justify-start tw-items-start tw-gap-1.5 tw-flex">
                      <div class="tw-self-stretch tw-h-14 tw-flex-col tw-justify-start tw-items-start tw-gap-1.5 tw-flex">
                        <form name="embedded-subscribe-form" id="mailchimp_form" class="tw-self-stretch tw-pl-3 tw-pr-1.5 tw-py-1.5 tw-bg-gray-50 tw-rounded-2xl tw-shadow tw-justify-start tw-items-center tw-gap-2 tw-inline-flex">
                          <input id="mailchimp_email_input" type="email" name="EMAIL" placeholder="Enter your email" required="" class="tw-w-full tw-text-gray-600 tw-text-base tw-font-normal tw-leading-normal tw-bg-gray-50 tw-border-none tw-h-12 tw-justify-start tw-items-center tw-gap-2 tw-flex tw-focus:outline-none tw-rounded-none tw-shadow-none tw-px-0 focus:tw-outline-none">
                          <button id="mailchimp_cta" type="submit" class="tw-w-auto tw-text-base tw-font-medium tw-leading-normal tw-px-6 tw-py-3 tw-rounded-xl tw-border tw-justify-center tw-items-center tw-gap-2 tw-flex tw:max-h-12 tw-text-white tw-cursor-pointer" style="background: linear-gradient(180deg, #635DFF 0%, #4D3DF7 100%), #7069FB;">Subscribe</button>
                        </form>
                      </div>
                      <div class="tw-text-left tw-self-stretch tw-text-gray-600 tw-text-sm tw-font-normal tw-font-sans tw-leading-tight tw-mt-1">By subscribing you agree to with our Privacy Policy and to receive updates from us.</div>
                    </div>
                  </div>
                </div>
                </span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_right tw-w-auto">
                    <div class="tw-w-full tw-h-60 tw-justify-start tw-items-start tw-inline-flex tw-gap-32">
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">Platform</div>
                          
<div class="tw-self-stretch tw-h-20 tw-flex-col tw-justify-start tw-items-start tw-flex tw-text-left">
    <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="/" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Documentation</a>
  </div>
    <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/pricing" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Pricing</a>
  </div>
</div>

                      </div>
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">resources</div>
                        
<div class="tw-self-stretch tw-h-40 tw-flex-col tw-justify-start tw-items-start tw-flex tw-text-left">
  <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/resources" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Blog</a>
  </div>
  <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/team" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">About us</a>
  </div>
</div>

                      </div>
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">Follow Us</div>
                        <ul class="tw-relative tw-z-10 tw-flex-col tw-justify-between tw-items-start tw-flex tw-gap-4 tw-w-full tw-mt-2 tw-text-left">
                        
<a href="https://github.com/otterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/github.svg" alt="GitHub logo" classname="w-5 h-5 relative">
</a>
<a href="https://www.linkedin.com/company/otterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/linkedin.svg" alt="LinkedIn logo" classname="w-5 h-5 relative">
</a>
<a href="https://x.com/TheOtterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/x.svg" alt="X logo" classname="w-5 h-5 relative">
</a>
<a href="https://joinslack.otterize.com/">
  <img width="30" height="30" loading="lazy" src="/img/footer/slack.svg" alt="Slack logo" classname="w-5 h-5 relative">
</a>
<a href="https://www.youtube.com/@OtterizeOfficial">
  <img width="30" height="30" loading="lazy" src="/img/footer/youtube.svg" alt="YouTube logo" classname="w-5 h-5 relative">
</a>

                        </ul>
                      </div>
                    </div>
                  </div></span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_copyright tw-w-full">
                    <div style="display:flex;">
                      <img src="/img/footer/cloud-native.svg" style="margin-right:20px;">
                      <a href="https://otterize.com/soc2-request" target="_blank" style="height:50px;">
                        <img src="/img/footer/soc.png" style="width:50px;">
                      </a>
                    </div>
                    <div class="tw-w-full tw-h-14 tw-flex-col tw-justify-start tw-items-start tw-gap-8 tw-inline-flex">
                    <div class="tw-self-stretch tw-h-px tw-bg-gray-300"></div>
                    <div class="tw-self-stretch tw-justify-between tw-items-start tw-inline-flex">
                      <div class="tw-text-gray-500 tw-text-sm tw-font-normal tw-font-sans tw-leading-tight">© 2024 Otterize. All rights reserved.</div>
                      <div class="tw-justify-start tw-items-start tw-gap-6 tw-flex">
                        <a href="https://status.otterize.com/" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Service Status</a>
                        <a href="https://otterize.com/privacy" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Privacy Policy</a>
                        <a href="https://otterize.com/terms" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Terms of Service</a>
                        <a href="" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Cookies Settings</a>
                      </div>
                    </div>
                  </div>
                </div></span></div></div></div></footer></div>
<script src="/assets/js/runtime~main.d8e6c6c1.js"></script>
<script src="/assets/js/main.2e15d3e2.js"></script>
</body>
</html>