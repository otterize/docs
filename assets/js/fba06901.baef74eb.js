"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5106],{5680:(e,t,r)=>{r.d(t,{xA:()=>p,yg:()=>g});var n=r(6540);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(r),m=a,g=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return r?n.createElement(g,o(o({ref:t},p),{},{components:r})):n.createElement(g,o({ref:t},p))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=r[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},6411:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(6540);function a(e){let{items:t,colSize:r}=e,a="lg:tw-grid-cols-2 tw-gap-4 xs:tw-grid-cols-1 ";return"lg"===r?a="lg:tw-grid-cols-4 tw-gap-2 xs:tw-grid-cols-2":"md"===r&&(a="lg:tw-grid-cols-3 tw-gap-2 xs:tw-grid-cols-1 md:tw-grid-cols-2"),n.createElement("div",{className:`tw-grid ${a}`},t.map((e=>n.createElement("div",{key:e.title,className:"tw-relative tw-flex tw-items-center tw-space-x-3 tw-rounded-lg tw-border tw-border-solid tw-border-primary-500 tw-bg-white tw-px-6 tw-py-5 tw-shadow-sm focus-within:tw-ring-2 focus-within:tw-ring-indigo-500 focus-within:tw-ring-offset-2 hover:tw-border-primary-600 hover:tw-shadow-md"},e.icon&&n.createElement("div",{className:"tw-flex-shrink-0"},n.createElement("img",{width:"40px",className:"tw-max-h-10 tw-max-w-10",src:e.icon,alt:""})),n.createElement("div",{className:"tw-min-w-0 tw-flex-1"},n.createElement("a",{href:e.url,className:"focus:tw-outline-none hover:tw-no-underline"},n.createElement("span",{className:"tw-absolute tw-inset-0","aria-hidden":"true"}),n.createElement("div",{className:"tw-text-md tw-font-medium tw-text-gray-900 tw-break-keep"},e.title),e.description&&n.createElement("div",{className:"tw-text-sm tw-text-gray-500"},e.description)))))))}},1160:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>g,frontMatter:()=>o,metadata:()=>s,toc:()=>p,tutorials:()=>u});var n=r(8168),a=(r(6540),r(5680)),i=r(6411);const o={sidebar_position:1,title:"GCP IAM | Overview",hide_table_of_contents:!0,hide_title:!0},l=void 0,s={unversionedId:"features/gcp-iam/index",id:"features/gcp-iam/index",title:"GCP IAM | Overview",description:"Otterize can create just-in-time GCP IAM workload identities & role assignments for your workloads running on GKE Kubernetes clusters, greatly simplifying the lifecycle of managing GCP IAM identities and roles.",source:"@site/docs/features/gcp-iam/index.mdx",sourceDirName:"features/gcp-iam",slug:"/features/gcp-iam/",permalink:"/features/gcp-iam/",draft:!1,editUrl:"https://github.com/otterize/docs/edit/main/docs/features/gcp-iam/index.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"GCP IAM | Overview",hide_table_of_contents:!0,hide_title:!0},sidebar:"docSidebar",previous:{title:"Reference",permalink:"/features/azure-iam/reference"},next:{title:"Automate GCP IAM for GKE",permalink:"/features/gcp-iam/tutorials/gcp-iam-gke"}},c={},p=[{value:"Tutorials",id:"tutorials",level:3},{value:"How does Otterize work with GCP IAM?",id:"how-does-otterize-work-with-gcp-iam",level:3},{value:"Automatically generating ClientIntents for GCP IAM",id:"automatically-generating-clientintents-for-gcp-iam",level:3}],u=[{title:"Automate GCP IAM for GKE",description:"Create just-in-time GCP IAM roles and policies that are kept in sync with your workloads",url:"/features/gcp-iam/tutorials/gcp-iam-gke"}],d={toc:p,tutorials:u},m="wrapper";function g(e){let{components:t,...r}=e;return(0,a.yg)(m,(0,n.A)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"gcp-iam"},"GCP IAM"),(0,a.yg)("p",null,"Otterize can create just-in-time GCP IAM workload identities & role assignments for your workloads running on GKE Kubernetes clusters, greatly simplifying the lifecycle of managing GCP IAM identities and roles."),(0,a.yg)("h3",{id:"tutorials"},"Tutorials"),(0,a.yg)("p",null,"To learn how to use the Intents Operator and Credentials Operator to manage just-in-time GCP IAM access, check out the tutorial."),(0,a.yg)(i.A,{items:u,colSize:"sm",mdxType:"DocsLinkCard"}),(0,a.yg)("h3",{id:"how-does-otterize-work-with-gcp-iam"},"How does Otterize work with GCP IAM?"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"First, the GKE cluster must have:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Enabled ",(0,a.yg)("a",{parentName:"li",href:"https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity"},"workload identity federation for GKE")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://cloud.google.com/config-connector/docs/how-to/install-upgrade-uninstall"},"Config Connector Installed")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"/overview/installation"},"Otterize installed"),"."))),(0,a.yg)("li",{parentName:"ol"},"To have a role created for a pod, label the pod with ",(0,a.yg)("inlineCode",{parentName:"li"},'credentials-operator.otterize.com/create-gcp-sa: "true"')),(0,a.yg)("li",{parentName:"ol"},"The credentials operator will:",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Annotate the pod ServiceAccount and Namespace with the relevant workload identity and Otterize labels."),(0,a.yg)("li",{parentName:"ul"},"Create a GCP ServiceAccount and bind it to the pod ServiceAccount."))),(0,a.yg)("li",{parentName:"ol"},"At this point, the pod is connected to your GCP project through the newly created GCP ServiceAccount but does not have any permissions to perform any action. We will need to create a ClientIntents YAML for the access the service requires and apply it to our cluster. Below is an example of a ClientIntents file for accessing a GCS bucket. View the ",(0,a.yg)("a",{parentName:"li",href:"/features/gcp-iam/reference"},"reference")," to learn more about the GCP IAM ClientIntents syntax."),(0,a.yg)("li",{parentName:"ol"},"Once the intent is applied, the intents operator will create a new GCP IAM policy, which will be attached to the service\u2019s role with the appropriate access."),(0,a.yg)("li",{parentName:"ol"},"Done!")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-yaml"},'apiVersion: k8s.otterize.com/v1alpha3\nkind: ClientIntents\nmetadata:\n  name: server\n  namespace: my-namespace\nspec:\n  service:\n    name: server\n  calls:\n    - name: projects/_/buckets/otterize-demo-bucket*\n      type: gcp\n      gcpPermissions:\n        - "storage.admin"\n')),(0,a.yg)("h3",{id:"automatically-generating-clientintents-for-gcp-iam"},"Automatically generating ClientIntents for GCP IAM"),(0,a.yg)("p",null,"Figuring out which access you need for GCP can be a painful, trial and error process, and something you ",(0,a.yg)("em",{parentName:"p"},"must")," do if you're tightening production access."),(0,a.yg)("p",null,"Otterize is getting ready to release support for using existing traffic to generate least-privilege IAM policies. Keen to try this out as part of early access? Sign up to the ",(0,a.yg)("a",{parentName:"p",href:"https://otterize.com/EarlyAccessBetaProgram"},"Early Access Beta Program")," and we'll be in touch!"))}g.isMDXComponent=!0}}]);