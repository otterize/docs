"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[472,7918],{5162:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(7294),o=n(6010);const r={tabItem:"tabItem_Ymn6"};function s(e){let{children:t,hidden:n,className:s}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(r.tabItem,s),hidden:n},t)}},4866:(e,t,n)=>{n.d(t,{Z:()=>N});var a=n(7462),o=n(7294),r=n(6010),s=n(2466),l=n(6550),c=n(1980),i=n(7392),u=n(12);function d(e){return function(e){return o.Children.map(e,(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:o}}=e;return{value:t,label:n,attributes:a,default:o}}))}function p(e){const{values:t,children:n}=e;return(0,o.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,i.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function k(e){let{queryString:t=!1,groupId:n}=e;const a=(0,l.k6)(),r=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c._X)(r),(0,o.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(a.location.search);t.set(r,e),a.replace({...a.location,search:t.toString()})}),[r,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,r=p(e),[s,l]=(0,o.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:r}))),[c,i]=k({queryString:n,groupId:a}),[d,g]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,r]=(0,u.Nk)(n);return[a,(0,o.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:a}),b=(()=>{const e=c??d;return m({value:e,tabValues:r})?e:null})();(0,o.useLayoutEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:s,selectValue:(0,o.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),i(e),g(e)}),[i,g,r]),tabValues:r}}var b=n(2389);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:t,block:n,selectedValue:l,selectValue:c,tabValues:i}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.o5)(),p=e=>{const t=e.currentTarget,n=u.indexOf(t),a=i[n].value;a!==l&&(d(t),c(a))},m=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t)},i.map((e=>{let{value:t,label:n,attributes:s}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:p},s,{className:(0,r.Z)("tabs__item",h.tabItem,s?.className,{"tabs__item--active":l===t})}),n??t)})))}function y(e){let{lazy:t,children:n,selectedValue:a}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===a));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return o.createElement("div",{className:"margin-top--md"},r.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function v(e){const t=g(e);return o.createElement("div",{className:(0,r.Z)("tabs-container",h.tabList)},o.createElement(f,(0,a.Z)({},e,t)),o.createElement(y,(0,a.Z)({},e,t)))}function N(e){const t=(0,b.Z)();return o.createElement(v,(0,a.Z)({key:String(t)},e))}},3155:(e,t,n)=>{n.d(t,{Z:()=>Z});var a=n(7462),o=n(7294),r=n(2389),s=n(6010),l=n(6412),c=n(5281),i=n(7016);const u={codeBlockContainer:"codeBlockContainer_APcc"};function d(e){let{as:t,...n}=e;const r=(0,l.p)(),d=(0,i.QC)(r);return o.createElement(t,(0,a.Z)({},n,{style:d,className:(0,s.Z)(n.className,u.codeBlockContainer,c.k.common.codeBlock)}))}const p={codeBlockContent:"codeBlockContent_m3Ux",codeBlockTitle:"codeBlockTitle_P25_",codeBlock:"codeBlock_qGQc",codeBlockStandalone:"codeBlockStandalone_zC50",codeBlockLines:"codeBlockLines_p187",codeBlockLinesWithNumbering:"codeBlockLinesWithNumbering_OFgW",buttonGroup:"buttonGroup_6DOT"};function m(e){let{children:t,className:n}=e;return o.createElement(d,{as:"pre",tabIndex:0,className:(0,s.Z)(p.codeBlockStandalone,"thin-scrollbar",n)},o.createElement("code",{className:p.codeBlockLines},t))}var k=n(6668),g=n(5448),b=n(3746);const h={codeLine:"codeLine_iPqp",codeLineNumber:"codeLineNumber_F4P7",codeLineContent:"codeLineContent_pOih"};var f=n(4996);function y(e){let{line:t,classNames:n,showLineNumbers:r,getLineProps:l,getTokenProps:c}=e;1===t.length&&"\n"===t[0].content&&(t[0].content="");const i=l({line:t,className:(0,s.Z)(n,r&&h.codeLine)}),u=t.map(((e,t)=>o.createElement("span",(0,a.Z)({key:t},c({token:e,key:t})))));return o.createElement("span",i,r?o.createElement(o.Fragment,null,o.createElement("span",{className:h.codeLineNumber}),o.createElement("span",{className:h.codeLineContent},u)):u,o.createElement("br",null))}var v=n(195),N=n(5999),C=n(345),w=n(7666);const E={copyButtonCopied:"copyButtonCopied__QnY",copyButtonIcons:"copyButtonIcons_FhaS",copyButtonIcon:"copyButtonIcon_phi_",copyButtonSuccessIcon:"copyButtonSuccessIcon_FfTR"};function B(e){let{code:t,className:n}=e;const[a,r]=(0,o.useState)(!1),l=(0,o.useRef)(void 0),c=(0,o.useCallback)((()=>{(0,v.Z)(t),r(!0),l.current=window.setTimeout((()=>{r(!1)}),1e3)}),[t]);return(0,o.useEffect)((()=>()=>window.clearTimeout(l.current)),[]),o.createElement("button",{type:"button","aria-label":a?(0,N.I)({id:"theme.CodeBlock.copied",message:"Copied",description:"The copied button label on code blocks"}):(0,N.I)({id:"theme.CodeBlock.copyButtonAriaLabel",message:"Copy code to clipboard",description:"The ARIA label for copy code blocks button"}),title:(0,N.I)({id:"theme.CodeBlock.copy",message:"Copy",description:"The copy button label on code blocks"}),className:(0,s.Z)("clean-btn",n,E.copyButton,a&&E.copyButtonCopied),onClick:c},o.createElement("span",{className:E.copyButtonIcons,"aria-hidden":"true"},o.createElement(C.Z,{className:E.copyButtonIcon}),o.createElement(w.Z,{className:E.copyButtonSuccessIcon})))}var I=n(670);const L={wordWrapButtonIcon:"wordWrapButtonIcon_iowe",wordWrapButtonEnabled:"wordWrapButtonEnabled_gY8A"};function q(e){let{className:t,onClick:n,isEnabled:a}=e;const r=(0,N.I)({id:"theme.CodeBlock.wordWrapToggle",message:"Toggle word wrap",description:"The title attribute for toggle word wrapping button of code block lines"});return o.createElement("button",{type:"button",onClick:n,className:(0,s.Z)("clean-btn",t,a&&L.wordWrapButtonEnabled),"aria-label":r,title:r},o.createElement(I.Z,{className:L.wordWrapButtonIcon,"aria-hidden":"true"}))}function S(e){let{children:t,className:n="",metastring:r,title:c,showLineNumbers:u,language:m}=e;const{prism:{defaultLanguage:h,magicComments:v}}=(0,k.L)(),N=m??(0,i.Vo)(n)??h,C=(0,l.p)(),w=(0,g.F)(),E=(0,i.bc)(r)||c,{lineClassNames:I,code:L}=(0,i.nZ)(t,{metastring:r,language:N,magicComments:v}),S=(0,f.Z)("/",{absolute:!0}).slice(0,-1),Z=L.replaceAll("${ABSOLUTE_URL}",S),T=u??(0,i.nt)(r);return o.createElement(d,{as:"div",className:(0,s.Z)(n,N&&!n.includes(`language-${N}`)&&`language-${N}`)},E&&o.createElement("div",{className:p.codeBlockTitle},E),o.createElement("div",{className:p.codeBlockContent},o.createElement(b.ZP,(0,a.Z)({},b.lG,{theme:C,code:Z,language:N??"text"}),(e=>{let{className:t,tokens:n,getLineProps:a,getTokenProps:r}=e;return o.createElement("pre",{tabIndex:0,ref:w.codeBlockRef,className:(0,s.Z)(t,p.codeBlock,"thin-scrollbar")},o.createElement("code",{className:(0,s.Z)(p.codeBlockLines,T&&p.codeBlockLinesWithNumbering)},n.map(((e,t)=>o.createElement(y,{key:t,line:e,getLineProps:a,getTokenProps:r,classNames:I[t],showLineNumbers:T})))))})),o.createElement("div",{className:p.buttonGroup},(w.isEnabled||w.isCodeScrollable)&&o.createElement(q,{className:p.codeButton,onClick:()=>w.toggle(),isEnabled:w.isEnabled}),o.createElement(B,{className:p.codeButton,code:Z}))))}function Z(e){let{children:t,...n}=e;const s=(0,r.Z)(),l=function(e){return o.Children.toArray(e).some((e=>(0,o.isValidElement)(e)))?e:Array.isArray(e)?e.join(""):e}(t),c="string"==typeof l?S:m;return o.createElement(c,(0,a.Z)({key:String(s)},n),l)}},2810:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>i});var a=n(7462),o=(n(7294),n(3905));n(3155),n(4866),n(5162);const r={sidebar_position:2,title:"Just-in-time PostgreSQL users & access",image:"/img/quick-tutorials/postgresql/social.png"},s=void 0,l={unversionedId:"quickstart/access-control/postgresql",id:"quickstart/access-control/postgresql",title:"Just-in-time PostgreSQL users & access",description:"Otterize automates PostgreSQL access management and secrets for your workloads, all in Kubernetes.",source:"@site/docs/quickstart/access-control/postgresql.mdx",sourceDirName:"quickstart/access-control",slug:"/quickstart/access-control/postgresql",permalink:"/quickstart/access-control/postgresql",draft:!1,editUrl:"https://github.com/otterize/docs/edit/main/docs/quickstart/access-control/postgresql.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Just-in-time PostgreSQL users & access",image:"/img/quick-tutorials/postgresql/social.png"},sidebar:"docSidebar",previous:{title:"Automate AWS IAM for EKS",permalink:"/quickstart/access-control/aws-iam-eks"},next:{title:"Istio AuthorizationPolicy automation",permalink:"/quickstart/access-control/k8s-istio-authorization-policies"}},c={},i=[{value:"Deploy Otterize for PostgreSQL",id:"deploy-otterize-for-postgresql",level:2},{value:"Install Otterize",id:"install-otterize",level:3},{value:"Create database integration",id:"create-database-integration",level:3},{value:"Configure your workloads",id:"configure-your-workloads",level:2},{value:"Pod annotaion",id:"pod-annotaion",level:3},{value:"ClientIntents",id:"clientintents",level:3},{value:"Can I also map SQL calls?",id:"can-i-also-map-sql-calls",level:3}],u={toc:i},d="wrapper";function p(e){let{components:t,...r}=e;return(0,o.kt)(d,(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Otterize automates PostgreSQL access management and secrets for your workloads, all in Kubernetes."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(8009).Z,width:"1478",height:"324"})),(0,o.kt)("p",null,"Connect to ",(0,o.kt)("a",{parentName:"p",href:"https://app.otterize.com"},"Otterize Cloud")," to get started!"),(0,o.kt)("h2",{id:"deploy-otterize-for-postgresql"},"Deploy Otterize for PostgreSQL"),(0,o.kt)("h3",{id:"install-otterize"},"Install Otterize"),(0,o.kt)("p",null,"Head over to the ",(0,o.kt)("a",{parentName:"p",href:"https://app.otterize.com/clusters"},"Clusters page")," and create a cluster.\nFollow the connection guide that opens to connect your cluster, and make the following changes:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Under ",(0,o.kt)("inlineCode",{parentName:"p"},"mTLS and Kafka support")," choose ",(0,o.kt)("inlineCode",{parentName:"p"},"Otterize Cloud"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enable enforcement. The configuration tab should look like this:\n",(0,o.kt)("img",{alt:"Cluster connection guide",src:n(6430).Z,width:"715",height:"389"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy the Helm command and ",(0,o.kt)("b",null,"add")," the following flag:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"--set intentsOperator.operator.enableDatabaseReconciler=true\n")))),(0,o.kt)("h3",{id:"create-database-integration"},"Create database integration"),(0,o.kt)("p",null,"Create a ",(0,o.kt)("em",{parentName:"p"},"Database")," integration of type ",(0,o.kt)("em",{parentName:"p"},"PostgreSQL")," on the ",(0,o.kt)("a",{parentName:"p",href:"https://app.otterize.com/integrations"},"Integrations page"),"."),(0,o.kt)("h2",{id:"configure-your-workloads"},"Configure your workloads"),(0,o.kt)("h3",{id:"pod-annotaion"},"Pod annotaion"),(0,o.kt)("p",null,"Annotate a pod, requesting a user and a password to be provisioned and bound to the pod."),(0,o.kt)("p",null,"Annotate the pod with this annotation:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"credentials-operator.otterize.com/user-password-secret-name: booking-service-secret")),(0,o.kt)("p",null,"Otterize then provisions credentials for this specific workload in this namespace in this cluster, that is not shared with other workloads."),(0,o.kt)("h3",{id:"clientintents"},"ClientIntents"),(0,o.kt)("p",null,"Declare your workload\u2019s ClientIntents, specifying desired permissions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"apiVersion: k8s.otterize.com/v1alpha3\nkind: ClientIntents\nmetadata:\n  name: booking-service\n  namespace: flight-search\nspec:\n  service:\n    name: booking-service\n  calls:\n    - name: bookings\n      type: database\n      databaseResources:\n        - table: users\n          databaseName: bookings-db\n          operations:\n            - SELECT\n        - table: products\n          databaseName: bookings-db\n          operations:\n            - ALL\n")),(0,o.kt)("p",null,"Otterize then creates a user and matching grants on the target database."),(0,o.kt)("h3",{id:"can-i-also-map-sql-calls"},"Can I also map SQL calls?"),(0,o.kt)("admonition",{title:"Coming soon",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Capture SQL calls for pods in your cluster, automatically generating the required least-privilege permissions, or ClientIntents, for each workload. Zero-friction in development, zero-trust in production. It\u2019s coming.")),(0,o.kt)("p",null,"If you want to learn more, and meet other Otterize users, please ",(0,o.kt)("a",{parentName:"p",href:"https://joinslack.otterize.com/"},"Join our Community")," and chat with us!"))}p.isMDXComponent=!0},6430:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/connect-cluster-cloud-with-enforcement-38a51721af810040de5716608c6b8ed6.png"},8009:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/cloud-842720d8de450186a5abdd74840f34a9.png"}}]);