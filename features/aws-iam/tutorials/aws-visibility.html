<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-features/aws-iam/tutorials/aws-visibility" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">AWS resource mapping | Otterize</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.otterize.com/features/aws-iam/tutorials/aws-visibility"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="AWS resource mapping | Otterize"><meta data-rh="true" name="description" content="Many production Kubernetes workloads depend on cloud resources, such as S3 buckets, RDS databases, and Lambda functions. In this tutorial, you will learn how Otterize can enhance your visibility into the AWS resources that are accessed by your workloads."><meta data-rh="true" property="og:description" content="Many production Kubernetes workloads depend on cloud resources, such as S3 buckets, RDS databases, and Lambda functions. In this tutorial, you will learn how Otterize can enhance your visibility into the AWS resources that are accessed by your workloads."><meta data-rh="true" property="og:image" content="https://docs.otterize.com/img/quick-tutorials/aws-iam-visibility/social.png"><meta data-rh="true" name="twitter:image" content="https://docs.otterize.com/img/quick-tutorials/aws-iam-visibility/social.png"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.otterize.com/features/aws-iam/tutorials/aws-visibility"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/features/aws-iam/tutorials/aws-visibility" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.otterize.com/features/aws-iam/tutorials/aws-visibility" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://69PZ47MO2R-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Otterize" href="/opensearch.xml">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2EG876ZREF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2EG876ZREF",{})</script>

<script src="/newsLetterSubscription.js" async></script>
<script src="/ui.js" async></script>
<script src="/pixels.js" async></script>
<script src="https://app.otterize.com/static/hs.js" async></script><link rel="stylesheet" href="/assets/css/styles.03945528.css">
<link rel="preload" href="/assets/js/runtime~main.f4572067.js" as="script">
<link rel="preload" href="/assets/js/main.c7d50f12.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://otterize.com" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--light_HNdA" style="padding-left:15px"><img src="/img/otterize-logo-light.svg" alt="Otterize" class="themedImage_ToTc themedImage--dark_i4oU" style="padding-left:15px"></div></a><a href="https://docs.otterize.com/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Documentation</div></a><a href="https://otterize.com/resources?categories=Lab&amp;page=1&amp;search=" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Labs</div></a><a href="https://www.otterize.com/pricing" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Pricing</div></a><a href="https://www.otterize.com/resources" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-inline tw-font-normal tw-text-base">Blog</div></a></div><div class="navbar__items navbar__items--right"><a href="https://app.otterize.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><div id="login-link" class="tw-inline-flex tw-h-11 tw-w-24 tw-items-center tw-justify-center tw-gap-2 tw-rounded-lg tw-px-4 tw-py-2.5 tw-text-sm lg:tw-text-base tw-font-semibold tw-leading-normal tw-text-gray-600 tw-no-underline -tw-mr-10">Log in</div></a><a href="https://joinslack.otterize.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><img width="30" height="30" loading="lazy" src="/img/footer/slack.svg" alt="Slack logo" classname="w-5 h-5 relative"></a><a href="https://otterize.com/signup" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><button class="tw-cursor-pointer tw-inline-flex tw-items-center tw-justify-center tw-gap-2 tw-rounded-xl tw-bg-gradient-to-b tw-px-3 tw-py-2.5 tw-text-sm lg:tw-text-base tw-font-semibold tw-leading-normal tw-no-underline tw-shadow tw-font-sans -tw-mr-2 tw-from-indigo-500 tw-bg-indigo-500 tw-to-indigo-600 tw-h-11 tw-border-none tw-text-white tw-w-full"><img src="/img/menu/cloud.svg">Signup <span id="sign-extended-text">for free<span></span></span></button></a><a href="https://otterize.com/book-demo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><div class="tw-cursor-pointer tw-font-sans tw-flex tw-items-center tw-rounded-xl tw-h-11 tw-border tw-border-solid tw-border-gray-300 tw-bg-white tw-px-3 tw-text-gray-900 tw-shadow tw-font-medium tw-text-sm lg:tw-text-base tw-w-full tw-justify-center"><span id="request-demo-full-text">Request a demo</span><span id="request-demo-partial-text">Demo</span><img class="tw-ml-2" src="/img/menu/right-arrow.svg"></div></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/features">Features</a><button aria-label="Toggle the collapsible sidebar category &#x27;Features&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/network-mapping-network-policies">Network mapping &amp; network policies</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network mapping &amp; network policies&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/features/aws-iam">AWS IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;AWS IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/features/aws-iam/tutorials/aws-iam-eks">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/features/aws-iam/tutorials/aws-iam-eks">Automate AWS IAM for EKS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/features/aws-iam/tutorials/aws-visibility">AWS resource mapping</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/features/aws-iam/reference">Reference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/azure-iam">Microsoft Azure IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;Microsoft Azure IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/gcp-iam">Google Cloud IAM</a><button aria-label="Toggle the collapsible sidebar category &#x27;Google Cloud IAM&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/kafka">Kafka</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kafka&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/istio">Istio</a><button aria-label="Toggle the collapsible sidebar category &#x27;Istio&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/mysql">MySQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;MySQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/postgresql">PostgreSQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;PostgreSQL&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/github">GitHub</a><button aria-label="Toggle the collapsible sidebar category &#x27;GitHub&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/gitlab">GitLab</a><button aria-label="Toggle the collapsible sidebar category &#x27;GitLab&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/features/linkerd">Linkerd</a><button aria-label="Toggle the collapsible sidebar category &#x27;Linkerd&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/reference/intents-operator">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/features"><span itemprop="name">Features</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/features/aws-iam"><span itemprop="name">AWS IAM</span></a><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tutorials</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">AWS resource mapping</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AWS resource mapping</h1></header><p>Many production Kubernetes workloads depend on cloud resources, such as S3 buckets, RDS databases, and Lambda functions. In this tutorial, you will learn how Otterize can enhance your visibility into the AWS resources that are accessed by your workloads.</p><p>In this tutorial, you will:</p><ul><li>Set up an EKS cluster.</li><li>Deploy two Lambda functions.</li><li>Deploy a <em>server</em> pod that retrieves a joke (as a string) from one Lambda function, reviews it, and posts the review to another Lambda function.</li><li>Automatically detect and monitor the Lambda function calls using Otterize.</li></ul><p>By the end of this tutorial, you will understand how to map Kubernetes workloads and their associated AWS resources using Otterize.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-tools">CLI tools<a href="#cli-tools" class="hash-link" aria-label="Direct link to CLI tools" title="Direct link to CLI tools">​</a></h3><p>You will need the following CLI tools to work with this environment:</p><ol><li><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" target="_blank" rel="noopener noreferrer">AWS CLI</a> - Ensure you have credentials within the target account that grant permissions to work with EKS clusters, IAM, CloudFormation, and Lambda functions.</li><li><a href="https://eksctl.io/installation/" target="_blank" rel="noopener noreferrer">eksctl</a> - This tool simplifies the creation and management of an EKS cluster.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-an-eks-cluster">Create an EKS cluster<a href="#create-an-eks-cluster" class="hash-link" aria-label="Direct link to Create an EKS cluster" title="Direct link to Create an EKS cluster">​</a></h3><p>Already have EKS cluster? Skip to the <a href="#enable-aws-visibility-with-otterize-installation">next step</a>.</p><p>Start by creating an EKS cluster for deploying your pods. Use the <strong>eksctl</strong> tool with the following YAML configuration:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token function" style="color:#79b6f2">curl</span><span class="token plain"> https://docs.otterize.com/code-examples/aws-visibility/eks-cluster.yaml </span><span class="token operator" style="color:#d7deea">|</span><span class="token plain"> eksctl create cluster -f -</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Inspect eks-cluster.yaml contents</summary><div><div class="collapsibleContent_i85q"><div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">apiVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> eksctl.io/v1alpha5</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">kind</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> ClusterConfig</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">aws</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">visibility</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">region</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> us</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">west</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">iam</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">withOIDC</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">vpc</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">clusterEndpoints</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">publicAccess</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">privateAccess</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">addons</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> vpc</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">cni</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">version</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> 1.14.0</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">attachPolicyARNs</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> arn</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">aws</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">iam</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">aws</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">policy/AmazonEKS_CNI_Policy</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">configurationValues</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">|</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">enableNetworkPolicy</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> coredns</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> kube</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">proxy</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">managedNodeGroups</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> x86</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">al2</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">on</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">demand</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">amiFamily</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> AmazonLinux2</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">instanceTypes</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;t3.large&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">minSize</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">desiredCapacity</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">maxSize</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">privateNetworking</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">disableIMDSv1</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">volumeSize</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">volumeType</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> gp3</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">volumeEncrypted</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#ff8b50;font-weight:400">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">tags</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">team</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;eks&quot;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>Next, update your <strong>kubeconfig</strong> to connect with the new cluster.</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">aws eks update-kubeconfig --name otterize-tutorial-aws-visibility --region </span><span class="token string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-aws-visibility-with-ebpf">Enable AWS Visibility with eBPF<a href="#enable-aws-visibility-with-ebpf" class="hash-link" aria-label="Direct link to Enable AWS Visibility with eBPF" title="Direct link to Enable AWS Visibility with eBPF">​</a></h3><p>You will first need to install Otterize in your cluster. If your cluster is not already connected, you can do so by following the Kubernetes setup instructions detailed on the <a href="https://app.otterize.com/integrations" target="_blank" rel="noopener noreferrer">Integrations</a> page.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Important</div><div class="admonitionContent_S0QG"><p>When installing Otterize, append the following flag to the Helm command to enable the eBPF agent, which is responsible for inspecting SSL and non-SSL traffic and generates the visibility into AWS traffic:</p></div></div><div class="codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-text codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">helm upgrade ... --set networkMapper.nodeagent.enable=true</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial">Tutorial<a href="#tutorial" class="hash-link" aria-label="Direct link to Tutorial" title="Direct link to Tutorial">​</a></h2><p>Now that your environment is set up, you are ready to deploy the application components, including the AWS resources that Otterize will monitor.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-two-lambda-functions">Deploy two Lambda functions<a href="#deploy-two-lambda-functions" class="hash-link" aria-label="Direct link to Deploy two Lambda functions" title="Direct link to Deploy two Lambda functions">​</a></h3><p>First, you will deploy two Lambda functions: <code>DadJokeLambdaFunction</code> and <code>FeedbackLambdaFunction</code>. These functions will interact with your <em>server</em> pod to generate a dad joke training dataset. The <em>server</em> pod receives a joke from the <code>DadJokeLambdaFunction</code>, reviews the joke, and sends the feedback to the <code>FeedbackLambdaFunction</code>.</p><p>To deploy the Lambda functions and their required roles, use the following command:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token function" style="color:#79b6f2">curl</span><span class="token plain"> https://docs.otterize.com/code-examples/aws-visibility/cloudformation.yaml -o template.yaml </span><span class="token operator" style="color:#d7deea">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">aws cloudformation deploy --template-file template.yaml --stack-name OtterizeTutorialJokeTrainingStack --capabilities CAPABILITY_IAM --region </span><span class="token string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Inspect CloudFormation YAML</summary><div><div class="collapsibleContent_i85q"><div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">AWSTemplateFormatVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;2010-09-09&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">Description</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">&gt;</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  Stack creates two Lambda functions for dad jokes and feedback</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> plus the user and related policies</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">Resources</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">DadJokeLambdaExecutionRole</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;AWS::IAM::Role&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Properties</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">AssumeRolePolicyDocument</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">Version</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;2012-10-17&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">Statement</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">Effect</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">Principal</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">Service</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> lambda.amazonaws.com</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">Action</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;sts:AssumeRole&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Policies</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">PolicyName</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;DadJokeLambdaExecutionPolicy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">PolicyDocument</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">Version</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;2012-10-17&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token key atrule" style="color:#FAC863">Statement</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">Effect</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Action</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;logs:CreateLogGroup&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;logs:CreateLogStream&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;logs:PutLogEvents&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Resource</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;arn:aws:logs:*:*:*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">Effect</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Action</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;execute-api:Invoke&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">Resource</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">DadJokeLambda</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;AWS::Lambda::Function&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Properties</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Handler</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;index.handler&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Role</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> DadJokeLambdaExecutionRole.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Runtime</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;nodejs20.x&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Code</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">ZipFile</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">|</span><span class="token scalar string" style="color:#8dc891"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">          const https = require(&#x27;https&#x27;);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">          exports.handler = async (event) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">            return new Promise((resolve, reject) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              const options = {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                hostname: &#x27;icanhazdadjoke.com&#x27;,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                method: &#x27;GET&#x27;,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                headers: { &#x27;Accept&#x27;: &#x27;application/json&#x27; }</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              };</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              const req = https.request(options, (res) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                let data = &#x27;&#x27;;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                res.on(&#x27;data&#x27;, (chunk) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                  data += chunk;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                res.on(&#x27;end&#x27;, () =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                  resolve({</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                    statusCode: 200,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                    body: data,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                    headers: { &#x27;Content-Type&#x27;: &#x27;application/json&#x27; },</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                  });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              req.on(&#x27;error&#x27;, (e) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                reject({</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                  statusCode: 500,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                  body: &#x27;Error fetching dad joke&#x27;,</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">                });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              req.end();</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">            });</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">          };</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Timeout</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">FeedbackLambda</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;AWS::Lambda::Function&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Properties</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Handler</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;index.handler&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Role</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> DadJokeLambdaExecutionRole.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Runtime</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;nodejs20.x&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Code</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">ZipFile</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">|</span><span class="token scalar string" style="color:#8dc891"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">          exports.handler = async (event) =&gt; {</span><br></span><span class="token-line" style="color:#ffffff"><span class="token scalar string" style="color:#8dc891">              const payload = JSON.parse(event.body);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              const joke = payload.joke;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              const isFunny = payload.funny;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              console.log(&quot;Joke</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> joke);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              console.log(&quot;Is it funny</span><span class="token punctuation" style="color:#8dc891">?</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> isFunny);</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              return </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">statusCode</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">body</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> JSON.stringify(</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">message</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Feedback received, Adding To Training Set&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain">;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain">;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Timeout</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">LambdaInvokeUser</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;AWS::IAM::User&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">LambdaInvokePolicy</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Type</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;AWS::IAM::Policy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">Properties</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">PolicyName</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;LambdaInvokePolicy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">Users</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!Ref</span><span class="token plain"> LambdaInvokeUser</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">PolicyDocument</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">Version</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;2012-10-17&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">Statement</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">Effect</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">Action</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;lambda:InvokeFunction&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">Resource</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> DadJokeLambda.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> FeedbackLambda.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">Outputs</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">DadJokeLambdaFunction</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Description</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Dad Joke Lambda Function ARN&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Value</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> DadJokeLambda.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">FeedbackLambdaFunction</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Description</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;Feedback Lambda Function ARN&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Value</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!GetAtt</span><span class="token plain"> FeedbackLambda.Arn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">LambdaInvokeUserAccessKeyId</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Description</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;IAM User Name for accessing Joke Lambda&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">Value</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token tag" style="color:#fc929e">!Ref</span><span class="token plain"> LambdaInvokeUser</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-server-with-access-to-lambda-functions">Deploy server with access to Lambda functions<a href="#deploy-server-with-access-to-lambda-functions" class="hash-link" aria-label="Direct link to Deploy server with access to Lambda functions" title="Direct link to Deploy server with access to Lambda functions">​</a></h3><p>With the Lambda functions deployed, you&#x27;re now ready to deploy your <em>server</em> pod and configure it to interact with the two Lambda functions. Follow these steps to set up your environment:</p><ul><li>Create a namespace:</li></ul><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl create namespace otterize-tutorial-aws-visibility</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Retrieve Lambda ARNs:</li></ul><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token assign-left variable" style="color:#d7deea">DAD_JOKE_LAMBDA_ARN</span><span class="token operator" style="color:#d7deea">=</span><span class="token variable" style="color:#d7deea">$(</span><span class="token variable" style="color:#d7deea">aws cloudformation describe-stacks --region </span><span class="token variable string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><span class="token variable" style="color:#d7deea"> --stack-name OtterizeTutorialJokeTrainingStack --query </span><span class="token variable string" style="color:#8dc891">&quot;Stacks[0].Outputs[?OutputKey==&#x27;DadJokeLambdaFunction&#x27;].OutputValue&quot;</span><span class="token variable" style="color:#d7deea"> --output text</span><span class="token variable" style="color:#d7deea">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token assign-left variable" style="color:#d7deea">FEEDBACK_LAMBDA_ARN</span><span class="token operator" style="color:#d7deea">=</span><span class="token variable" style="color:#d7deea">$(</span><span class="token variable" style="color:#d7deea">aws cloudformation describe-stacks --region </span><span class="token variable string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><span class="token variable" style="color:#d7deea"> --stack-name OtterizeTutorialJokeTrainingStack --query </span><span class="token variable string" style="color:#8dc891">&quot;Stacks[0].Outputs[?OutputKey==&#x27;FeedbackLambdaFunction&#x27;].OutputValue&quot;</span><span class="token variable" style="color:#d7deea"> --output text</span><span class="token variable" style="color:#d7deea">)</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Create a <code>ConfigMap</code> for Lambda ARNs:</li></ul><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl create configmap lambda-arns </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">dadJokeLambdaArn</span><span class="token operator" style="color:#d7deea">=</span><span class="token variable" style="color:#d7deea">$DAD_JOKE_LAMBDA_ARN</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">feedbackLambdaArn</span><span class="token operator" style="color:#d7deea">=</span><span class="token variable" style="color:#d7deea">$FEEDBACK_LAMBDA_ARN</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  -n otterize-tutorial-aws-visibility</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Generate AWS credentials and create a <code>Secret</code>:</li></ul><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token assign-left variable" style="color:#d7deea">USER_NAME</span><span class="token operator" style="color:#d7deea">=</span><span class="token variable" style="color:#d7deea">$(</span><span class="token variable" style="color:#d7deea">aws cloudformation describe-stacks --region </span><span class="token variable string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><span class="token variable" style="color:#d7deea"> --stack-name OtterizeTutorialJokeTrainingStack --query </span><span class="token variable string" style="color:#8dc891">&quot;Stacks[0].Outputs[?OutputKey==&#x27;LambdaInvokeUserAccessKeyId&#x27;].OutputValue&quot;</span><span class="token variable" style="color:#d7deea"> --output text</span><span class="token variable" style="color:#d7deea">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">aws iam create-access-key --user-name </span><span class="token string" style="color:#8dc891">&quot;</span><span class="token string variable" style="color:#d7deea">$USER_NAME</span><span class="token string" style="color:#8dc891">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">jq -r </span><span class="token string" style="color:#8dc891">&#x27;&quot;--from-literal=AWS_ACCESS_KEY_ID=&quot;+.AccessKey.AccessKeyId+&quot; --from-literal=AWS_SECRET_ACCESS_KEY=&quot;+.AccessKey.SecretAccessKey&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token function" style="color:#79b6f2">xargs</span><span class="token plain"> kubectl create secret generic aws-credentials -n otterize-tutorial-aws-visibility</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Deploy the <em>server</em> pod:</li></ul><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl apply -n otterize-tutorial-aws-visibility -f https://docs.otterize.com/code-examples/aws-visibility/all.yaml</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Inspect deployment YAML</summary><div><div class="collapsibleContent_i85q"><div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token key atrule" style="color:#FAC863">apiVersion</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">kind</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> joketrainer</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">namespace</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">aws</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">visibility</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">replicas</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">selector</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">matchLabels</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">app</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> joketrainer</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">  </span><span class="token key atrule" style="color:#FAC863">template</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">metadata</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">labels</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">app</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> joketrainer</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token key atrule" style="color:#FAC863">network-mapper.otterize.com/aws-visibility</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">    </span><span class="token key atrule" style="color:#FAC863">spec</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">      </span><span class="token key atrule" style="color:#FAC863">containers</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> joketrainer</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">image</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> otterize/aws</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">visibility</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">tutorial</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">          </span><span class="token key atrule" style="color:#FAC863">env</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> AWS_ACCESS_KEY_ID</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">valueFrom</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">secretKeyRef</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">key</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> AWS_ACCESS_KEY_ID</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> AWS_SECRET_ACCESS_KEY</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">valueFrom</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">secretKeyRef</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> aws</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">credentials</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">key</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> AWS_SECRET_ACCESS_KEY</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> DAD_JOKE_LAMBDA_ARN</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">valueFrom</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">configMapKeyRef</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> lambda</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">arns</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">key</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> dadJokeLambdaArn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> FEEDBACK_LAMBDA_ARN</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">              </span><span class="token key atrule" style="color:#FAC863">valueFrom</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                </span><span class="token key atrule" style="color:#FAC863">configMapKeyRef</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">name</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> lambda</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">arns</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">                  </span><span class="token key atrule" style="color:#FAC863">key</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> feedbackLambdaArn</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><p>In the Kubernetes <code>Deployment</code> manifest, you will notice the following label in the pod template: <code>network-mapper.otterize.com/aws-visibility</code>. This label instructs the network mapper to track AWS API calls for this pod, helping identify the resources and actions being utilized.</p><p>Once the pod is deployed, you can verify the logs to confirm it is successfully calling the Lambda functions:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl logs -f -n otterize-tutorial-aws-visibility deploy/joketrainer</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example output:</p><div class="codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-text codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">Joke: People saying &#x27;boo! to their friends has risen by 85% in the last year.... That&#x27;s a frightening statistic.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Sending Feedback of Funny?: Yes</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Joke: Have you ever heard of a music group called Cellophane? They mostly wrap.</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Sending Feedback of Funny?: Yes</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Joke: What did Yoda say when he saw himself in 4K? &quot;HDMI&quot;</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain">Sending Feedback of Funny?: No</span><br></span><span class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualize-relationships">Visualize Relationships<a href="#visualize-relationships" class="hash-link" aria-label="Direct link to Visualize Relationships" title="Direct link to Visualize Relationships">​</a></h3><p>With Otterize monitoring the AWS API calls, access Otterize Cloud to observe both Lambdas in action. The <a href="https://app.otterize.com/access-graph" target="_blank" rel="noopener noreferrer">Access graph</a> will display two AWS resources associated with the <em>joketrainer</em> pod: <em>DadJokeLambdaFunction</em> and <em>FeedbackLambdaFunction</em>.</p><p><img loading="lazy" alt="Otterize Cloud AWS Visibility Example" src="/assets/images/aws-iam-visibility-1aca009207662a89f7abce3057158174.png" width="1494" height="978" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&#x27;s Next<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next" title="Direct link to What&#x27;s Next">​</a></h3><p>Now that you have learned how to enable visibility for AWS resources in your Kubernetes cluster, you are ready to explore how to manage access to these resources. Continue your learning journey with the next tutorial: <a href="/features/aws-iam/tutorials/aws-iam-eks">Automate AWS IAM for EKS</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cleanup">Cleanup<a href="#cleanup" class="hash-link" aria-label="Direct link to Cleanup" title="Direct link to Cleanup">​</a></h2><p>To remove the deployed example:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">kubectl delete namespace otterize-tutorial-aws-visibility</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To remove the Lambda functions:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">aws cloudformation delete-stack --stack-name OtterizeTutorialJokeTrainingStack --region </span><span class="token string" style="color:#8dc891">&#x27;us-west-2&#x27;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To remove the EKS cluster:</p><div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:#282c34;--prism-color:#ffffff"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar"><code class="codeBlockLines_p187"><span class="token-line" style="color:#ffffff"><span class="token plain">eksctl delete cluster --name otterize-tutorial-aws-visibility --region us-west-2</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/otterize/docs/edit/main/docs/features/aws-iam/tutorials/aws-visibility.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/features/aws-iam/tutorials/aws-iam-eks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Automate AWS IAM for EKS</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/features/aws-iam/reference"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#cli-tools" class="table-of-contents__link toc-highlight">CLI tools</a></li><li><a href="#create-an-eks-cluster" class="table-of-contents__link toc-highlight">Create an EKS cluster</a></li><li><a href="#enable-aws-visibility-with-ebpf" class="table-of-contents__link toc-highlight">Enable AWS Visibility with eBPF</a></li></ul></li><li><a href="#tutorial" class="table-of-contents__link toc-highlight">Tutorial</a><ul><li><a href="#deploy-two-lambda-functions" class="table-of-contents__link toc-highlight">Deploy two Lambda functions</a></li><li><a href="#deploy-server-with-access-to-lambda-functions" class="table-of-contents__link toc-highlight">Deploy server with access to Lambda functions</a></li><li><a href="#visualize-relationships" class="table-of-contents__link toc-highlight">Visualize Relationships</a></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next</a></li></ul></li><li><a href="#cleanup" class="table-of-contents__link toc-highlight">Cleanup</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><span class="footer__link-item">
                <div class="footer_left">
                  <div class="tw-w-96 tw-h-60 tw-flex-col tw-justify-start tw-items-start tw-gap-6 tw-inline-flex">
                    <div class="tw-w-36 tw-h-8 tw-justify-start tw-items-start tw-inline-flex">
                      <img class="tw-w-40 tw-h-16 tw-relative tw-rounded-lg" src="/img/logo.svg">
                    </div>
                    <div id="mailchimp_title" class="tw-w-96 tw-text-gray-700 tw-text-xl tw-font-normal tw-font-sans tw-text-left">Join our newsletter to stay up to date on features and releases.</div>
                    <div class="tw-h-28 tw-flex-col tw-justify-start tw-items-start tw-gap-1.5 tw-flex">
                      <div class="tw-self-stretch tw-h-14 tw-flex-col tw-justify-start tw-items-start tw-gap-1.5 tw-flex">
                        <form name="embedded-subscribe-form" id="mailchimp_form" class="tw-self-stretch tw-pl-3 tw-pr-1.5 tw-py-1.5 tw-bg-gray-50 tw-rounded-2xl tw-shadow tw-justify-start tw-items-center tw-gap-2 tw-inline-flex">
                          <input id="mailchimp_email_input" type="email" name="EMAIL" placeholder="Enter your email" required="" class="tw-w-full tw-text-gray-600 tw-text-base tw-font-normal tw-leading-normal tw-bg-gray-50 tw-border-none tw-h-12 tw-justify-start tw-items-center tw-gap-2 tw-flex tw-focus:outline-none tw-rounded-none tw-shadow-none tw-px-0 focus:tw-outline-none">
                          <button id="mailchimp_cta" type="submit" class="tw-w-auto tw-text-base tw-font-medium tw-leading-normal tw-px-6 tw-py-3 tw-rounded-xl tw-border tw-justify-center tw-items-center tw-gap-2 tw-flex tw:max-h-12 tw-text-white tw-cursor-pointer" style="background: linear-gradient(180deg, #635DFF 0%, #4D3DF7 100%), #7069FB;">Subscribe</button>
                        </form>
                      </div>
                      <div class="tw-text-left tw-self-stretch tw-text-gray-600 tw-text-sm tw-font-normal tw-font-sans tw-leading-tight tw-mt-1">By subscribing you agree to with our Privacy Policy and to receive updates from us.</div>
                    </div>
                  </div>
                </div>
                </span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_right tw-w-auto">
                    <div class="tw-w-full tw-h-60 tw-justify-start tw-items-start tw-inline-flex tw-gap-32">
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">Platform</div>
                          
<div class="tw-self-stretch tw-h-20 tw-flex-col tw-justify-start tw-items-start tw-flex tw-text-left">
    <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="/" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Documentation</a>
  </div>
    <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/pricing" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Pricing</a>
  </div>
</div>

                      </div>
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">resources</div>
                        
<div class="tw-self-stretch tw-h-40 tw-flex-col tw-justify-start tw-items-start tw-flex tw-text-left">
  <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/resources" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">Blog</a>
  </div>
  <div class="tw-self-stretch tw-py-2 tw-justify-start tw-items-start tw-inline-flex">
    <a href="https://www.otterize.com/team" class="tw-grow tw-shrink tw-basis-0 tw-text-sky-950 tw-text-base tw-font-medium tw-font-sans tw-leading-normal tw-cursor-pointer !tw-no-underline">About us</a>
  </div>
</div>

                      </div>
                      <div class="tw-grow tw-shrink tw-basis-0 tw-flex-col tw-justify-start tw-items-start tw-gap-4 tw-inline-flex tw-w-[120px] tw-max-w-[240px]">
                        <div class="tw-self-stretch tw-text-gray-500 tw-text-sm tw-font-semibold tw-font-sans tw-uppercase tw-leading-none tw-tracking-widest tw-text-left">Follow Us</div>
                        <ul class="tw-relative tw-z-10 tw-flex-col tw-justify-between tw-items-start tw-flex tw-gap-4 tw-w-full tw-mt-2 tw-text-left">
                        
<a href="https://github.com/otterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/github.svg" alt="GitHub logo" classname="w-5 h-5 relative">
</a>
<a href="https://www.linkedin.com/company/otterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/linkedin.svg" alt="LinkedIn logo" classname="w-5 h-5 relative">
</a>
<a href="https://x.com/TheOtterize">
  <img width="30" height="30" loading="lazy" src="/img/footer/x.svg" alt="X logo" classname="w-5 h-5 relative">
</a>
<a href="https://joinslack.otterize.com/">
  <img width="30" height="30" loading="lazy" src="/img/footer/slack.svg" alt="Slack logo" classname="w-5 h-5 relative">
</a>
<a href="https://www.youtube.com/@OtterizeOfficial">
  <img width="30" height="30" loading="lazy" src="/img/footer/youtube.svg" alt="YouTube logo" classname="w-5 h-5 relative">
</a>

                        </ul>
                      </div>
                    </div>
                  </div></span><span class="footer__link-separator">·</span><span class="footer__link-item"><div class="footer_copyright tw-w-full">
                    <div style="display:flex;">
                      <img src="/img/footer/cloud-native.svg" style="margin-right:20px;">
                      <a href="https://otterize.com/soc2-request" target="_blank" style="height:50px;">
                        <img src="/img/footer/soc.png" style="width:50px;">
                      </a>
                    </div>
                    <div class="tw-w-full tw-h-14 tw-flex-col tw-justify-start tw-items-start tw-gap-8 tw-inline-flex">
                    <div class="tw-self-stretch tw-h-px tw-bg-gray-300"></div>
                    <div class="tw-self-stretch tw-justify-between tw-items-start tw-inline-flex">
                      <div class="tw-text-gray-500 tw-text-sm tw-font-normal tw-font-sans tw-leading-tight">© 2025 Otterize. All rights reserved.</div>
                      <div class="tw-justify-start tw-items-start tw-gap-6 tw-flex">
                        <a href="https://status.otterize.com/" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Service Status</a>
                        <a href="https://otterize.com/privacy" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Privacy Policy</a>
                        <a href="https://otterize.com/terms" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Terms of Service</a>
                        <a href="" class="tw-text-gray-500 tw-text-sm tw-font-medium tw-font-sans tw-leading-tight !tw-no-underline">Cookies Settings</a>
                      </div>
                    </div>
                  </div>
                </div></span></div></div></div></footer></div>
<script src="/assets/js/runtime~main.f4572067.js"></script>
<script src="/assets/js/main.c7d50f12.js"></script>
</body>
</html>